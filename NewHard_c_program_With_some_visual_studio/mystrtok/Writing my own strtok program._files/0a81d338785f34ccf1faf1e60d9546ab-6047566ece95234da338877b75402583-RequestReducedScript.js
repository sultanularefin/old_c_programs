var Forums={};Forums.Constants={ExpandCollapseImage:'<img src="'+ForumsRes.url_transGif+'" class="expcol"/>',ExpandCollapseLink:'<a class="expcol" href="javascript:void(0);"/>',ExpandCollapseImageRef:"img.expcol",ExpandCollapseLinkRef:"a.expcol"},Forums.Rte={IsOpen:!1,IsReady:!1,canShow:function(n){return Forums.Rte.IsOpen===!1?!0:(n===!0&&alert(ForumsRes.rte_alreadyOpen),!1)},show:function(){return Forums.Rte.IsOpen===!0?!1:(setTimeout(function(){Forums.Rte.IsReady=!0},ForumsRes.rte_readyDelay),Forums.Rte.IsOpen=!0,!0)},hide:function(){Forums.Rte.IsOpen=!1,Forums.Rte.IsReady=!1},isBodyLengthValid:function(n){var t=0;return n!==null&&Forums.Rte.trimString(n)!==""&&(t=n.length),t<4||t>6e4?(alert(ForumsRes.rte_msgBodyLength),!1):!0},trimString:function(n){var t=n.replace(/(\&nbsp\;)+/g," ");return t.replace(/^\s+|\s+$/g,"")},isUnTrustedUserPostValid:function(n){var t=Forums.Rte.getImageCount(n),i=Forums.Rte.getLinkCount(n);return t==0&&i==0},getImageCount:function(n){var i=new RegExp("<img+.*?((/>)|(</img>))","ig"),t=n===null||Forums.Rte.trimString(n)===""?0:n.match(i);return t==null&&(t=0),t},getLinkCount:function(n){var i=new RegExp("<a+.*?((/>)|)","ig"),t=n===null||Forums.Rte.trimString(n)===""?0:n.match(i);return t==null&&(t=0),t},isBodyImageCountValid:function(n){var u=0,f=new RegExp("Forums/getfile/?[0-9]*","ig"),t=Forums.Rte.getImageCount(n),i,r;if(t!==null&&t.length>0)for(i=0;i<t.length;i++)r=t[i].match(f),r!==null&&r.length>0&&u++;return u>ForumsRes.rte_MaxAttachments?!1:!0},UnPrettifyCodeBlocks:function(n){$("pre.prettyprint",n).each(function(){$(this).removeClass("prettyprinted"),$("span",$(this)).each(function(){$(this).replaceWith(function(){return $(this).contents()}),$(this).html($("<div/>").text($(this).html()).html())})})}},Forums.Filters={decorateFilters:function(){var n=$(this);$("h6",this).prepend(Forums.Constants.ExpandCollapseLink),$("h6",this).click(function(){$(n).children("div.content").children("div.advanced").slideToggle("fast"),$(n).toggleClass("expanded")}),$("h6",this).mouseover(function(){$(n).addClass("hover")}),$("h6",this).mouseout(function(){$(n).removeClass("hover")}),$("div.advanced li a",this).hasClass("selected")&&$("h6",this).click()}},Forums.Message={autoSubscribeValue:function(n){var t=!1,i,r;try{t=pageData.autoSubscribe,t||(i=$(n).parents("li.thread"),i!=null&&i.length>0?$("h3 > img",i).hasClass("alert")&&(t=!0):(r=$("ul.thread.menu > li > a[name='unsubscribe']"),r!=null&&r.length>0&&(t=!0)))}catch(u){}return t?"checked='checked'":""},edit:function(){var n=$(this).parents("li.message");$(this).click(function(){var u,f,e;if(!Forums.Rte.canShow(!0))return!1;var i=$(n).attr("id")+"body",r="<textarea class='rte' id='"+i+"'></textarea>",t=$("div.body",n);return Forums.Rte.UnPrettifyCodeBlocks(t),u=$("#"+$(n).attr("id")+"_attachments").attr("value"),$("div.quote",t).wrap("<blockquote/>"),f=$(t).html()+"<br/>",$.ajax({type:"POST",async:!1,url:ForumsRes.get_editorUrl,data:{Id:$(n).attr("id"),body:f},success:function(n){r=n}}),$(t).hide(),$("div.helpful, ul.history, div.abusive, div.menu, div.votingouterbox, div.voting,span.votinglabel",n).hide(),e="<div class='editor'><form>"+r+"<input type='hidden' name='attachmentIds' value='"+u+"'/></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>&nbsp;<label>"+ForumsRes.rte_reasonLabel+"</label><input type='text' name='reason'/></div><div class='ajaxError submitEditError'></div></div>",$(t).after(e),Forums.Rte.show(),$("button[name='submit']",n).click(Forums.Message.submitEdit(n,$(this).attr("url"))),$("button[name='cancel']",n).click(function(){Forums.Rte.hide(),$("#"+i).data("tEditor")!==undefined&&$("#"+i).data("tEditor").window.focus(),$("div.editor",n).remove(),$(t).show(),$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",n).show(),prettyPrint()}),$("button[name='submit']",n).get(0).scrollIntoView(!1),!1})},reply:function(){var n=$(this).parents("li.message");$(this).click(function(){var r,i,t;return Forums.Rte.canShow(!0)?(r=$(n).attr("id")+"body",i="<textarea class='rte' id='"+r+"'></textarea>",$.ajax({type:"POST",async:!1,url:ForumsRes.get_editorUrl,data:{Id:$(n).attr("id")},success:function(n){i=n}}),i=i.replace("if (!$.browser.msie || ($.browser.msie && $.browser.version >= 9))","if (!$.browser.msie || ($.browser.msie && $.browser.version >= 9 && document.documentMode >= 9))"),t="<div class='editor'><form>"+i+"<input type='hidden' name='attachmentIds'/></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>",userEmailConfigured&&(t=t+"&nbsp;<input type='checkbox' name='subscribe' "+Forums.Message.autoSubscribeValue(n)+"/><label>"+ForumsRes.rte_subscribeText+"</label>"),t+="<div><div class='submitReplyError ajaxerror'></div></div>",t=t+"</div></div>",$(n).append(t),Forums.Rte.show(),$("button[name='submit']",n).click(Forums.Message.submitReply(n,$(this).attr("url"))),$("button[name='cancel']",n).click(function(){Forums.Rte.hide(),$("#"+r).data("tEditor")!==undefined&&$("#"+r).data("tEditor").window.focus(),$("div.editor",n).remove()}),$("button[name='submit']",n).get(0).scrollIntoView(!1),!1):!1})},quote:function(){var n=$(this).parents("li.message");$(this).click(function(){var o,h,i;if(!Forums.Rte.canShow(!0))return!1;var f=$(n).attr("id")+"body",s="<textarea class='rte' id='"+f+"'></textarea>",r=$("div.body",n);r=r.clone(),Forums.Rte.UnPrettifyCodeBlocks(r);var t=$(r).html(),u="<blockquote>",e="</blockquote>";return t.substring(0,u.length)===u&&(t=t.replace(u,"<p>"),o=t.lastIndexOf(e),t=t.substring(0,o)+"</p>"+t.substring(o+e.length)),t=u+t+e+"<br/>",$.ajax({type:"POST",async:!1,url:ForumsRes.get_editorUrl,data:{Id:$(n).attr("id"),body:t},success:function(n){s=n}}),h=$("div.helpful",n),i="<div class='editor'><form>"+s+"<input type='hidden' name='attachmentIds' value='' /></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>",userEmailConfigured&&(i=i+"&nbsp;<input type='checkbox' name='subscribe' "+Forums.Message.autoSubscribeValue(n)+"/><label>"+ForumsRes.rte_subscribeText+"</label>"),i=i+"</div></div>",$(n).append(i),Forums.Rte.show(),$("button[name='submit']",n).click(Forums.Message.submitReply(n,$(this).attr("url"))),$("button[name='cancel']",n).click(function(){Forums.Rte.hide(),$("#"+f).data("tEditor")!==undefined&&$("#"+f).data("tEditor").window.focus(),$("div.editor",n).remove()}),$("button[name='submit']",n).get(0).scrollIntoView(!1),!1})},submitEdit:function(n,t){return function(){var u=$("div.editor",n),s=$(n).attr("id")+"body",i=$("#"+s),f=i[0].nodeName.toLowerCase(),r,e,o;if(f==="table"&&i.data("tEditor")===undefined)return!1;if($("div.editor button",n).attr("disabled","disabled"),r=f==="table"?i.data("tEditor").value():i.val(),$("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(r))return alert(ForumsRes.MessageBodyUnTrustedUser),$("button[name='submit']",n).attr("disabled",!1),$("button[name='cancel']",n).attr("disabled",!1),!1;if(!Forums.Rte.isBodyLengthValid(r))return $("button[name='submit']",n).attr("disabled",!1),$("button[name='cancel']",n).attr("disabled",!1),!1;$(u).append('<div class="submitting"></div>'),$(u).addClass("submitting"),e=$("div.editor > div.commands > input[name='reason']",n).val(),o=$("div.editor input[name='attachmentIds']",n).attr("value"),$.ajax({type:"POST",url:t,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),body:r,reason:e,attachmentIds:o},success:function(t){typeof t=="object"&&t.StatusCode=="500"?Forums.Common.ShowPrompt(t.Message,t.Confirm,t.Redirect):(Forums.Rte.hide(),f==="table"&&i.data("tEditor").window.focus(),$("div.editor",n).remove(),$(n).after(t).next().hide().fadeIn("fast").each(Forums.Message.decorateMessage),prettyPrint(),$(n).remove())},error:function(t){$("div.submitting",u).remove(),$("div.editor button",n).removeAttr("disabled"),alert(t.responseText)}})}},submitReply:function(n,t){return function(){var u=$("div.editor",n),s=$(n).attr("id")+"body",i=$("#"+s),f=i[0].nodeName.toLowerCase(),r,e,o;if(f==="table"&&i.data("tEditor")===undefined)return!1;if($("div.editor button",n).attr("disabled","disabled"),r=f==="table"?i.data("tEditor").value():i.val(),$("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(r))return alert(ForumsRes.MessageBodyUnTrustedUser),$("button[name='submit']",n).attr("disabled",!1),$("button[name='cancel']",n).attr("disabled",!1),!1;if(!Forums.Rte.isBodyLengthValid(r))return $("button[name='submit']",n).attr("disabled",!1),$("button[name='cancel']",n).attr("disabled",!1),!1;$(u).append('<div class="submitting"></div>'),$(u).addClass("submitting"),e=$("div.editor input[name='attachmentIds']",n).attr("value"),o=$("div.editor > div.commands > input[name='subscribe']",n).is(":checked"),$.ajax({type:"POST",url:t,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),body:r,attachmentIds:e,subscribe:o},success:function(t){typeof t=="object"&&t.StatusCode=="500"?Forums.Common.ShowPrompt(t.Message,t.Confirm,t.Redirect):(Forums.Rte.hide(),f==="table"&&i.data("tEditor").window.focus(),$("div.editor",n).remove(),$(n).after(t).next().hide().fadeIn("fast").addClass("new").each(Forums.Message.decorateMessage),prettyPrint())},error:function(t){$("div.submitting",u).remove(),$("div.editor button",n).removeAttr("disabled"),$("div.submitReplyError").html(t.responseText).show()}})}},messageAction:function(n,t){return function(){var i=$(n).parents("li.message"),r=$(i).attr("id");return $(i).append('<div class="submitting"></div>'),$(i).addClass("submitting"),t.__RequestVerificationToken=Forums.Message.AddAntiForgeryToken(),url=$(n).attr("url")?$(n).attr("url"):$(n).attr("href"),$.ajax({type:"POST",url:url,data:t,success:function(n){$("li.message[id='"+r+"']").replaceWith(n),$("li.message[id='"+r+"']").each(Forums.Message.decorateMessage)},error:function(n){$("div.submitting",i).remove(),alert(n.responseText)}}),!1}},promptAction:function(n,t,i){return function(){return Forums.HTML.createPopup(t),$("#okButton").click(function(){i.reason=$("#reason").attr("value"),Forums.Message.messageAction(n,i)();var t=$(n).parents("li.message");$(".menu.message",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),$("#reason").keypress(function(n){n.which==13&&$("#okButton").click()}),$("#cancelButton").click(function(){var t=$(n).parents("li.message");$(".menu.message",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),$("#closeButton").click(function(){var t=$(n).parents("li.message");$(".menu.message",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),!1}},answer:function(){$(this).click(Forums.Message.messageAction($(this),{isAnswer:!0}))},unanswer:function(){$(this).click(Forums.Message.messageAction($(this),{isAnswer:!1}))},proposeAnswer:function(){$(this).click(Forums.Message.messageAction($(this),{isProposed:!0}))},unproposeAnswer:function(){$(this).click(Forums.Message.messageAction($(this),{isProposed:!1}))},clearAbuse:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_clearAbuseReason,{isAbuse:!1}))},reportAbuse:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_reportAbuseReason,{isAbuse:!0}))},deleteMessage:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_deleteReason,{isDeleted:!0}))},undeleteMessage:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_undeleteReason,{isDeleted:!1}))},gotoUrl:function(){return $(this).click(function(){window.location=$(this).attr("url")}),!1},voteHelpful:function(){var n=$(this);$(this).click(function(){$(n).fadeOut("fast");var t=$(n).parents("li.message");return $("div.helpful > span > img",t).addClass("submitting"),$.ajax({type:"POST",url:$(n).attr("href"),data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),isHelpful:!0},dataType:"json",success:function(n){$("div.helpful > span > span",t).text(n.Votes),$("div.helpful > span > img",t).removeClass("submitting")},error:function(n){$("div.helpful > span > img",t).removeClass("submitting"),alert(n.responseText)}}),!1})},voteUp:function(){$(this).click(Forums.Message.messageAction($(this),{isHelpful:!0}))},voteDown:function(){$(this).click(Forums.Message.messageAction($(this),{isHelpful:!1}))},decorateMessage:function(){var t,n;if(typeof pageData=="undefined"||pageData==null||pageData.validUser==!1){t=$("div.menu.message",this),$("a[name='reply']",t).each(Forums.Message.gotoUrl),$("a[name='quote']",t).each(Forums.Message.gotoUrl),$("div.helpful a.vote",this).each(Forums.Message.gotoUrl);return}$("a[name='reportAbuse']",this).each(Forums.Message.reportAbuse),$("a[name='clearAbuse']",this).each(Forums.Message.clearAbuse),$("div.helpful a.vote",this).each(Forums.Message.voteHelpful),$("a[name='voteup']",this).each(Forums.Message.voteUp),$("a[name='votedown']",this).each(Forums.Message.voteDown),n=$("div.menu.message",this),$("a[name='setAnswer']",n).each(Forums.Message.answer),$("a[name='unsetAnswer']",n).each(Forums.Message.unanswer),$("a[name='proposeAnswer']",n).each(Forums.Message.proposeAnswer),$("a[name='unproposeAnswer']",n).each(Forums.Message.unproposeAnswer),$("a[name='reply']",n).each(Forums.Message.reply),$("a[name='quote']",n).each(Forums.Message.quote),$("a[name='edit']",n).each(Forums.Message.edit),$("a[name='delete']",n).each(Forums.Message.deleteMessage),$("a[name='undelete']",n).each(Forums.Message.undeleteMessage),$("a[name='split']",n).each(Forums.Message.gotoUrl),$("a.popup").popup()},AddAntiForgeryToken:function(){return $("#__AjaxAntiForgeryForm input[name='__RequestVerificationToken']").attr("value")}},Forums.HTML={createPopup:function(n){var u,t,i,f,r;$("#boxes").length>0&&($("#mask").remove(),$("#dialog").remove(),$("#boxes").remove()),u="<div id='boxes'><div id='dialog' class='window'><div class='poupTitle'><label id='resonLabel'>"+n+"</label><img title='Close' id='closeButton' class='icon delete' src=\""+ForumsRes.url_transGif+"\" complete='complete' ></img></div><div style='padding:0px 5px 10px 5px;'><span class='textSpan'><input type='text' id='reason' name='reason' value='' /></span><span class='buttonSpan'><button id='okButton' name='ok' >"+ForumsRes.rte_OKText+"</button><button id='cancelButton' name='cancel' > "+ForumsRes.rte_cancelText+"</button></span></div></div><div id='mask'></div></div>",$("body").append(u),t="#dialog",i="#mask",$("#reason").select(),$("#reason").focus(),f=($(window).height()-$(t).height())/2+$(window).scrollTop(),r=($(window).width()-$(t).width())/2+$(window).scrollLeft(),$(t).css({top:f,left:r>0?r:0,display:"block"}),this.addAnimation(t),$(i).css({top:0,left:0,width:$(document).width(),height:$(document).height()}),$(i).fadeTo("fast",.5)},addAnimation:function(n){$(window).resize(function(){var i=($(window).height()-$(n).height())/2+$(window).scrollTop(),t=($(window).width()-$(n).width())/2+$(window).scrollLeft();$(n).css({top:i,left:t>0?t:0})}),$(window).scroll(function(){var i=($(window).height()-$(n).height())/2+$(window).scrollTop(),t=($(window).width()-$(n).width())/2+$(window).scrollLeft();$(n).css({top:i,left:t>0?t:0})})}},Forums.Thread={threadAction:function(n,t){return function(){return $("img.icon",n).addClass("submitting"),t.__RequestVerificationToken=Forums.Message.AddAntiForgeryToken(),url=$(n).attr("url")?$(n).attr("url"):$(n).attr("href"),$.ajax({type:"POST",url:url,data:t,dataType:"json",success:function(n){window.location=n.url},error:function(t){$("img.icon",n).removeClass("submitting"),alert(t.responseText)}}),!1}},promptAction:function(n,t,i){return function(){return Forums.HTML.createPopup(t),$("#okButton").click(function(){var t,r;if(i.stickyDate=="")if(t=$("#reason").attr("value"),Forums.Thread.isStickyDateValid(t))i.stickyDate=$("#reason").attr("value");else return $("#reason").val(""),alert(ForumsRes.StickyDateInValid),!1;else i.reason=$("#reason").attr("value");Forums.Thread.threadAction(n,i)(),r=$(n).parents("li.message.root"),$("ul.menu.thread",r).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),$("#reason").keypress(function(n){n.which==13&&$("#okButton").click()}),$("#cancelButton").click(function(){var t=$(n).parents("li.message.root");$("ul.menu.thread",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),$("#closeButton").click(function(){var t=$(n).parents("li.message.root");$("ul.menu.thread",t).get(0).scrollIntoView(!1),$("#mask, .window").hide()}),!1}},AddAntiForgeryToken:function(){return $("#__AjaxAntiForgeryForm input[name='__RequestVerificationToken']").attr("value")},editThread:function(){var n=$(this).parents("li.message");$(this).click(function(){var u,f,e;if(!Forums.Rte.canShow(!0))return!1;var i=$(n).attr("id")+"body",r="<textarea class='rte' id='"+i+"'></textarea>",o=$("#content > h1 > span[name='subject']").text(),t=$("div.body",n);return Forums.Rte.UnPrettifyCodeBlocks(t),u=$("#"+$(n).attr("id")+"_attachments").attr("value"),f=$(t).html()+"<br/>",$.ajax({type:"POST",async:!1,url:ForumsRes.get_editorUrl,data:{Id:$(n).attr("id"),body:f},success:function(n){r=n}}),$(t).hide(),$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",n).hide(),e="<div class='editor'><label>"+ForumsRes.rte_subjectLabel+"</label> <input type='text' id='subject' size='60' /><form>"+r+"<input type='hidden' name='attachmentIds' value='"+u+"'/></form><div class='commands'><button id='submit'>"+ForumsRes.rte_submitText+"</button><button id='cancel'>"+ForumsRes.rte_cancelText+"</button>&nbsp;<label>"+ForumsRes.rte_reasonLabel+"</label><input type='text' id='reason'/></div><div><div class='submitEditError ajaxerror'></div></div></div>",$(t).after(e),$("#subject",n).val(o),Forums.Rte.show(),$("#submit",n).click(Forums.Thread.submitEdit(n,$(this).attr("url"))),$("#cancel",n).click(function(){Forums.Rte.hide(),$("#"+i).data("tEditor")!==undefined&&$("#"+i).data("tEditor").window.focus(),$("div.editor",n).remove(),$(t).show(),$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",n).show(),prettyPrint()}),$("#submit",n).get(0).scrollIntoView(!1),!1})},submitEdit:function(n,t){return function(){var u=$("div.editor"),f=$("div.editor",n),o=$(n).attr("id")+"body",i=$("#"+o),e=i[0].nodeName.toLowerCase(),r;if(e==="table"&&i.data("tEditor")===undefined)return!1;if(u.find("button").attr("disabled","disabled"),r=e==="table"?i.data("tEditor").value():i.val(),$("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(r))return alert(ForumsRes.MessageBodyUnTrustedUser),$("#submit",n).attr("disabled",!1),$("#cancel",n).attr("disabled",!1),!1;if(!Forums.Rte.isBodyLengthValid(r))return $("#submit",n).attr("disabled",!1),$("#cancel",n).attr("disabled",!1),!1;if(!Forums.Rte.isBodyImageCountValid(r))return alert(ForumsRes.rte_MaxAttachmentsErrMsg),$("#submit",n).attr("disabled",!1),$("#cancel",n).attr("disabled",!1),!1;$(f).append('<div class="submitting"></div>'),$(f).addClass("submitting");var s=u.find("#reason").val(),h=u.find("#subject").val(),c=$("div.editor input[name='attachmentIds']",n).attr("value");$.ajax({type:"POST",url:t,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),subject:h,body:r,reason:s,attachmentIds:c},dataType:"json",success:function(t){typeof t=="object"&&t.StatusCode&&t.StatusCode=="500"?Forums.Common.ShowPrompt(t.Message,t.Confirm,t.Redirect):(e==="table"&&i.data("tEditor").window.focus(),$("div.editor",n).remove(),window.location=t.url)},error:function(t){$("div.submitting",f).remove(),$("div.editor button",n).removeAttr("disabled"),$("div.submitEditError").html(t.responseText).show()}})}},clearSticky:function(){$(this).click(Forums.Thread.threadAction(this,{stickyDate:""}))},deleteThread:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_deleteReason,{isDeleted:!0}))},deescalateThread:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_deEscalateReason,{isEscalated:!1}))},escalateThread:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_escalateReason,{isEscalated:!0}))},lock:function(){$(this).click(Forums.Thread.threadAction(this,{isLocked:!0}))},makeSticky:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_stickyUntil,{stickyDate:""}))},subscribe:function(){$(this).click(Forums.Thread.threadAction(this,{isSubscribed:!0}))},undeleteThread:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_undeleteReason,{isDeleted:!1}))},unlock:function(){$(this).click(Forums.Thread.threadAction(this,{isLocked:!1}))},unsubscribe:function(){$(this).click(Forums.Thread.threadAction(this,{isSubscribed:!1}))},join:function(){$(this).click(Forums.Thread.threadAction($(this),{isJoined:!0}))},unjoin:function(){$(this).click(Forums.Thread.threadAction($(this),{isJoined:!1}))},decorateThreadMenu:function(){$("a[name='delete']",this).each(Forums.Thread.deleteThread),$("a[name='undelete']",this).each(Forums.Thread.undeleteThread),$("a[name='editThread']",this).each(Forums.Thread.editThread),$("a[name='lock']",this).each(Forums.Thread.lock),$("a[name='unlock']",this).each(Forums.Thread.unlock),$("a[name='sticky']",this).each(Forums.Thread.makeSticky),$("a[name='clearSticky']",this).each(Forums.Thread.clearSticky),$("a[name='subscribe']",this).each(Forums.Thread.subscribe),$("a[name='unsubscribe']",this).each(Forums.Thread.unsubscribe),$("a[name='escalate']",this).each(Forums.Thread.escalateThread),$("a[name='deEscalate']",this).each(Forums.Thread.deescalateThread),$("a[name='joinQuestion']").each(Forums.Thread.join),$("a[name='unJoinQuestion']").each(Forums.Thread.unjoin),$("a[name='move']").each(Forums.Message.gotoUrl),$("a[name='merge']").each(Forums.Message.gotoUrl),$("a[name='assign']").each(Forums.Message.gotoUrl),$("a[name='changeType']").each(Forums.Message.gotoUrl)},messagesLoaded:function(n){var t,r,u,i;$(n).removeClass("loading"),$(n).removeClass("hasUnread"),$(n).removeClass("new"),$(n).addClass("loaded"),$(n).addClass("viewed"),$("div.preview",n).append('<div class="links"></div>'),t=$("div.links",n),$(t).append('<a name="view"></a>'),r=$("a[name='view']",t),u=$("h3 a:eq(1)",n).attr("href"),$(r).text(ForumsRes.thread_viewThreadText).attr("href",u).attr("title",ForumsRes.thread_viewThreadText),$(t).append('<a name="close"></a>'),i=$("a[name='close']",t),$(i).text(ForumsRes.thread_closePreviewText).attr("href","javascript:void(0)").attr("title",ForumsRes.thread_closePreviewText),$(i).click(function(){$("h3",n).click()}),$("div.preview",n).slideToggle("fast"),$("li.message",n).each(Forums.Message.decorateMessage),prettyPrint()},decorateThread:function(){var n=$(this);$("h3 > a",this).before(Forums.Constants.ExpandCollapseLink),$(this).append('<div class="preview"></div>'),$("h3",this).click(function(t){if((t.target.nodeName.toLowerCase()!=="a"||t.target.className==="expcol")&&($(n).toggleClass("expanded"),!$(n).hasClass("loading"))){if($(n).hasClass("loaded")){$("div.editor button[name='cancel']",n).click(),$("div.preview",n).slideToggle("fast");return}$(n).addClass("loading");var i=$("h3:first > a:eq(1)",n).attr("href")+"/messages?time="+ +new Date;i=i.substring(7),i=i.substring(i.indexOf("/")),$("div.preview",n).load(i,null,function(){Forums.Thread.messagesLoaded(n),$("li.message",this).profileWidgitize()})}}),$("h3",this).mouseover(function(){$(n).addClass("hover")}),$("h3",this).mouseout(function(){$(n).removeClass("hover")})},isStickyDateValid:function(n){var t,u,r,f;if(n.length!=10||(t=n.split("-"),t.length!=3))return!1;for(u="^[0-9]+$",i=0;i<3;i++)if(!t[i].match(u))return!1;return(r=new Date(t[0],t[1]-1,t[2]),r.getFullYear()!=t[0]||r.getMonth()!=t[1]-1||r.getDate()!=t[2])?!1:(f=new Date,r<f?!1:!0)}},Forums.Homepage={wirePageElements:function(){Forums.Homepage.wireThreadListView(),Forums.Homepage.wireFilterBar(),Forums.Homepage.wireCategoryList(),Forums.Homepage.wireForumList(),Forums.Homepage.wireSearchBar(),Forums.Homepage.wireQuickLinks()},wireSearchBar:function(){$("table.searchboxinnercontainer #searchbox").watermark("Search forum questions")},wireThreadListView:function(){$("a.arrowdown").removeClass("invisible").addClass("visible"),$("a.arrowdown",".threadsnippet").click(function(){Forums.Homepage.expandThread($(this))})},wireCategoryList:function(){function n(n){window.location.href=n.attr("data-Url")}$(".categoryItem").click(function(){return n($(this)),!1}),$("#categoryFilter div.moreLink").click(function(n){return $("#allCategoryItems").is(":hidden")?($("#allCategoryItems").show(),n.stopPropagation(),$("body").click(function(){Forums.Homepage.hideCategoryPopup()})):Forums.Homepage.hideCategoryPopup(),!1}),$("#categoryFilter div.lessLink").click(function(){return Forums.Homepage.hideCategoryPopup(),!1})},wireForumList:function(){function n(n){window.location.href=n.attr("data-Url")}$(".forumItem").click(function(){return n($(this)),!1}),$(".forumFilter div.moreLink").click(function(){return $(this).siblings(".allForumItems").show(),$(this).hide(),!1}),$(".forumFilter div.lessLink").click(function(){return $(this).parent().hide(),!1})},expandThread:function(n){var i=$(n).parents("div.threadsnippet:first"),t=$(i).find("div.expandedThreadContainer"),r=$(i).find(".threadUrl:first").attr("href");$(n).hasClass("expanded")?Forums.Homepage.hideThreadPreview(t,$(n)):($(t).toggleClass("invisible visible").show(),$(n).addClass("expanded"),Forums.Homepage.loadThreadPreview(t,r))},loadThreadPreview:function(n,t){t+="messages?time="+ +new Date,$.ajax({type:"GET",url:t,success:function(t){$(n).html(t),$("#threadList").addClass("nowhitespace")},error:function(){}})},hideThreadPreview:function(n,t){$(t).removeClass("expanded"),$(n).toggleClass("visible invisible").hide()},wireQuickLinks:function(){$(".dropdown","#sidebar").click(function(n){Forums.Homepage.toggleQuickLinksDropDown($(this),n)})},wireFilterBar:function(){$(".filterdropdown","#filterBar").click(function(n){Forums.Homepage.toggleFilterDropDown($(this),n)}),$(".threadFilterItem").click(function(){window.location.href=$(this).attr("data-Url")})},hideDropDowns:function(){$("#filterBar .popup").hide(),$("#quickLinks .popup").hide()},hideCategoryPopup:function(){$("#allCategoryItems").hide()},toggleFilterDropDown:function(n,t){$(".filterdropdown","#filterBar").each(function(){$(n).attr("id")!=$(this).attr("id")&&$(this).children(".popup").hide()}),n.children(".popup").toggle(),t.stopPropagation(),$("body").click(function(){Forums.Homepage.hideDropDowns()})},toggleQuickLinksDropDown:function(n,t){$(".dropdown","#sidebar").each(function(){$(n).attr("id")!=$(this).attr("id")&&$(this).children(".popup").hide()}),n.children(".popup").toggle(),t.stopPropagation(),$("body").click(function(){Forums.Homepage.hideDropDowns()})}},Forums.Leaderboards={seeMore:function(n){var t=$("#rail div.leaderboards"),i;n++,n>4&&(n=0),i=window.leaderBoardUrl+"&leaderBoard="+n,t.fadeTo("slow",.5),t.addClass("submitting"),t.parent("div").load(i)}},Forums.Users={usersAction:function(n,t){return function(){return $("img.icon",n).addClass("submitting"),$.post($(n).attr("href"),t,function(){$(n).remove()},"json"),!1}},blockAvatar:function(){var n=$(this);$(this).click(Forums.Users.usersAction(n,{blockAvatar:!0}))},unblockAvatar:function(){var n=$(this);$(this).click(Forums.Users.usersAction(n,{blockAvatar:!1}))},decorateUsers:function(){$("a[name='blockUnblockAvatar']",this).each(Forums.Users.blockAvatar)}},Forums.Common={TrackCustomClick:function(n,t,i,r){typeof t_omni_utils!="undefined"&&t_omni_utils&&t_omni_utils.omniModTracking&&t_omni_utils.omniModTracking(!0,n,"",t,i,r)},FixPartnerForumContextUrls:function(n){var u=$("#p_ApplicationUrl"),r,t,i;typeof u!="undefined"&&u&&(r=$("#connect-context .home-link-container a",n),typeof r!="undefined"&&r&&r.attr("href",u.attr("value"))),t=$("#p_ApplicationForumContextUrl"),typeof t!="undefined"&&t&&(i=$("#connect-context .connection-link-container a",n),typeof i!="undefined"&&i&&(t.attr("value")?i.attr("href",t.attr("value")):i.remove()))},ShowPrompt:function(n,t,i){this.clicked=!0,$.prompt(n,{prefix:"spWarning",top:"40%",buttons:{closeButton:{title:t,value:!0}},submit:function(){window.location.replace(i)}})}},$.addToRail=function(n,t){for(var u,f,r=$("#rail"),i=0;i<n.length;i++)u=document.createElement("div"),r.append(u),f=n[i].indexOf("?")!=-1?"&":"?",n[i].indexOf("rightrailannouncement")!=-1?$(u).load(n[i]+f+"rnd="+Math.random(),null,function(){Forums.Common.FixPartnerForumContextUrls(r)}):$(u).load(n[i]+f+"rnd="+Math.random(),null,t),n[i].indexOf("leaderboards")!=-1&&(window.leaderBoardUrl=n[i]+f+"rnd="+Math.random());r.append($(".help",r))},$.fn.popup=function(){$(this).each(function(){var t="a[name='"+$(this).attr("name")+"']",n="ul[name='"+$(this).attr("name")+"Popup']",i;$(this).find(Forums.Constants.ExpandCollapseImageRef).detach(),$(this).append(Forums.Constants.ExpandCollapseImage),i=function(){$("ul.popup").hide(),$("body").unbind("click.popup")},$(this).click(function(r){var f,u,e;$("ul.popup").hide(),f=$(n).width(),u=$(t).position(),$(n).attr("popupAlign")==="right"?$(n).css("left",u.left+$(r.target).width()/2-f):$(n).attr("popupAlign")==="rightRail"?$(n).css("right",$(t).offsetParent().width()-u.left):$(n).css("left",u.left),e=r.target.className=="expcol"?r.target.parentElement:r.target,$(n).css("top",u.top+$(e).height()*1.5),$(n).show(),r.stopPropagation(),$("body").bind("click.popup",i)})})},Forums.ManageRoles={selectAll:function(){$("#selectAll").attr("checked")?$("input[name='userId']").attr("checked","checked"):$("input[name='userId']").attr("checked",!1)}},$.fn.removeWatermark=function(){$(this).each(function(){$(this).hasClass("watermark")&&($(this).val(""),$(this).removeClass("watermark"))})},$.removeAllWatermarks=function(){$(".watermark").each(function(){$(this).removeWatermark()})},$.fn.watermark=function(n){$(this).each(function(){$(this).removeWatermark(),$(this).bind("click",function(){$(this).hasClass("watermark")&&($(this).val(""),$(this).removeClass("watermark"))}),$(this).bind("blur",function(){($(this).val()==""||$(this).val()==n)&&($(this).addClass("watermark"),$(this).val(n))}),$(this).blur()})},$.fn.watermarkVal=function(){return $(this).hasClass("watermark")?"":$(this).val()},$("input#ErrorSearchButton").live("click",function(){var t=$("input#ErrorSearchBox").val(),n;t&&(n=$("input#SearchUri").val(),n)&&(window.location.href=n.replace("{0}",escape(t)))}),Forums.loadScript=function(n){$(document).ready(function(){$.ajax({async:!0,type:"GET",url:n,data:null,dataType:"script",cache:!0})})},$(document).ready(function(){}),function(n){n.prompt=function(t,i){var o,h;i=n.extend({},n.prompt.defaults,i),n.prompt.currentPrefix=i.prefix;var f=n.browser.msie&&n.browser.version<7,v=n(document.body),e=n(window);i.classes=n.trim(i.classes),i.classes!=""&&(i.classes=" "+i.classes),o='<div class="'+i.prefix+"box"+i.classes+'" id="'+i.prefix+'box">',i.useiframe&&(n("object, applet").length>0||f)?o+='<iframe src="javascript:false;" style="display:block;position:absolute;z-index:-1;" class="'+i.prefix+'fade" id="'+i.prefix+'fade"></iframe>':(f&&n("select").css("visibility","hidden"),o+='<div class="'+i.prefix+'fade" id="'+i.prefix+'fade"></div>'),o+='<div class="'+i.prefix+'" id="'+i.prefix+'"><div class="'+i.prefix+'container"><div class="',o+=i.prefix+'close">X</div><div id="'+i.prefix+'states"></div>',o+="</div></div></div>";var r=n(o).appendTo(v),u=r.children("#"+i.prefix),s=r.children("#"+i.prefix+"fade");t.constructor==String&&(t={state0:{html:t,buttons:i.buttons,focus:i.focus,submit:i.submit}}),h="",n.each(t,function(r,u){u=n.extend({},n.prompt.defaults.state,u),t[r]=u,h+='<div id="'+i.prefix+"_state_"+r+'" class="'+i.prefix+'_state" style="display:none;"><div class="'+i.prefix+'message">'+u.html+'</div><div class="'+i.prefix+'buttons">',n.each(u.buttons,function(n,t){h+=typeof t=="object"?'<button name="'+i.prefix+"_"+r+"_button"+t.title.replace(/[^a-z0-9]+/gi,"")+'" id="'+i.prefix+"_"+r+"_button"+t.title.replace(/[^a-z0-9]+/gi,"")+'" value="'+t.value+'">'+t.title+"</button>":'<button name="'+i.prefix+"_"+r+"_button"+n+'" id="'+i.prefix+"_"+r+"_button"+n+'" value="'+t+'">'+n+"</button>"}),h+="</div></div>"}),u.find("#"+i.prefix+"states").html(h).children("."+i.prefix+"_state:first").css("display","block"),u.find("."+i.prefix+"buttons:empty").css("display","none"),n.each(t,function(t,r){var f=u.find("#"+i.prefix+"_state_"+t);f.children("."+i.prefix+"buttons").children("button").click(function(){var h=f.children("."+i.prefix+"message"),e=r.buttons[n(this).text()],o,t,s;if(e==undefined)for(o in r.buttons)r.buttons[o].title==n(this).text()&&(e=r.buttons[o].value);typeof e=="object"&&(e=e.value),t={},n.each(u.find("#"+i.prefix+"states :input").serializeArray(),function(n,i){t[i.name]===undefined?t[i.name]=i.value:typeof t[i.name]==Array||typeof t[i.name]=="object"?t[i.name].push(i.value):t[i.name]=[t[i.name],i.value]}),s=r.submit(e,h,t),(s===undefined||s)&&a(!0,e,h,t)}),f.find("."+i.prefix+"buttons button:eq("+r.focus+")").addClass(i.prefix+"defaultbutton")});var y=function(){r.css({top:e.scrollTop()})},c=function(){var n,t;i.persistent?(n=0,r.addClass(i.prefix+"warning"),t=setInterval(function(){r.toggleClass(i.prefix+"warning"),n++>1&&(clearInterval(t),r.removeClass(i.prefix+"warning"))},100)):a()},p=function(t){var u=window.event?event.keyCode:t.keyCode;if(u==27&&c(),u==9){var i=n(":input:enabled:visible",r),e=!t.shiftKey&&t.target==i[i.length-1],f=t.shiftKey&&t.target==i[0];if(e||f)return setTimeout(function(){if(i){var n=i[f===!0?i.length-1:0];n&&n.focus()}},10),!1}},l=function(){r.css({position:f?"absolute":"fixed",height:e.height(),width:"100%",top:f?e.scrollTop():0,left:0,right:0,bottom:0}),s.css({position:"absolute",height:e.height(),width:"100%",top:0,left:0,right:0,bottom:0}),u.css({position:"absolute",top:i.top,left:"50%",marginLeft:u.outerWidth()/-2})},w=function(){s.css({zIndex:i.zIndex,display:"none",opacity:i.opacity}),u.css({zIndex:i.zIndex+1,display:"none"}),r.css({zIndex:i.zIndex})},a=function(t,o,h,a){u.remove(),f&&v.unbind("scroll",y),e.unbind("resize",l),s.fadeOut(i.overlayspeed,function(){s.unbind("click",c),s.remove(),t&&i.callback(o,h,a),r.unbind("keypress",p),r.remove(),f&&!i.useiframe&&n("select").css("visibility","visible")})};return l(),w(),f&&e.scroll(y),s.click(c),e.resize(l),r.bind("keydown keypress",p),u.find("."+i.prefix+"close").click(a),s.fadeIn(i.overlayspeed),u[i.show](i.promptspeed,i.loaded),u.find("#"+i.prefix+"states ."+i.prefix+"_state:first ."+i.prefix+"defaultbutton").focus(),i.timeout>0&&setTimeout(n.prompt.close,i.timeout),r},n.prompt.defaults={prefix:"jqi",classes:"",buttons:{Ok:!0},loaded:function(){},submit:function(){return!0},callback:function(){},opacity:.6,zIndex:999,overlayspeed:"slow",promptspeed:"fast",show:"fadeIn",focus:0,useiframe:!1,top:"15%",persistent:!0,timeout:0,state:{html:"",buttons:{Ok:!0},focus:0,submit:function(){return!0}}},n.prompt.currentPrefix=n.prompt.defaults.prefix,n.prompt.setDefaults=function(t){n.prompt.defaults=n.extend({},n.prompt.defaults,t)},n.prompt.setStateDefaults=function(t){n.prompt.defaults.state=n.extend({},n.prompt.defaults.state,t)},n.prompt.getStateContent=function(t){return n("#"+n.prompt.currentPrefix+"_state_"+t)},n.prompt.getCurrentState=function(){return n("."+n.prompt.currentPrefix+"_state:visible")},n.prompt.getCurrentStateName=function(){var t=n.prompt.getCurrentState().attr("id");return t.replace(n.prompt.currentPrefix+"_state_","")},n.prompt.goToState=function(t,i){n("."+n.prompt.currentPrefix+"_state").slideUp("slow"),n("#"+n.prompt.currentPrefix+"_state_"+t).slideDown("slow",function(){n(this).find("."+n.prompt.currentPrefix+"defaultbutton").focus(),typeof i=="function"&&i()})},n.prompt.nextState=function(t){var i=n("."+n.prompt.currentPrefix+"_state:visible").next();n("."+n.prompt.currentPrefix+"_state").slideUp("slow"),i.slideDown("slow",function(){i.find("."+n.prompt.currentPrefix+"defaultbutton").focus(),typeof t=="function"&&t()})},n.prompt.prevState=function(t){var i=n("."+n.prompt.currentPrefix+"_state:visible").prev();n("."+n.prompt.currentPrefix+"_state").slideUp("slow"),i.slideDown("slow",function(){i.find("."+n.prompt.currentPrefix+"defaultbutton").focus(),typeof t=="function"&&t()})},n.prompt.close=function(){n("#"+n.prompt.currentPrefix+"box").fadeOut("fast",function(){n(this).remove()})},n.fn.prompt=function(t){t==undefined&&(t={}),t.withDataAndEvents==undefined&&(t.withDataAndEvents=!1),n.prompt(n(this).clone(t.withDataAndEvents).html(),t)}}(jQuery)